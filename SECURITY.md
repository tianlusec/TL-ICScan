# 安全政策 (Security Policy)

[English Version](SECURITY_EN.md)

## 支持的版本 (Supported Versions)

我们为以下版本提供安全更新支持：

| 版本 (Version) | 支持状态 (Supported) | 说明 (Notes) |
| -------------- | -------------------- | ------------ |
| 0.6.x          | :white_check_mark:   | 当前版本，完全支持 |
| 0.5.x          | :white_check_mark:   | 维护中，重要安全修复 |
| < 0.5.0        | :x:                  | 不再支持，请升级 |

**建议**: 始终使用最新的稳定版本以获得最佳安全性和功能。

## 报告安全漏洞 (Reporting a Vulnerability)

### 重要提示

如果您发现了本项目的安全漏洞，请**不要**在 GitHub Issue 中公开披露。我们采用负责任的披露流程来保护用户安全。

### 报告方式

请通过以下方式之一联系我们：

1. **GitHub Security Advisories** (推荐)
   - 访问项目的 [Security Advisories](https://github.com/tianlusec/TL-ICScan/security/advisories)
   - 点击 "Report a vulnerability"
   - 填写详细信息

2. **电子邮件**
   - 发送至：security@tianlulab.com
   - 主题格式：`[SECURITY] TL-ICScan - 简短描述`
   - 如有 PGP 密钥，请使用加密邮件

3. **私密 Issue**
   - 在 GitHub 上创建私密安全报告

### 报告内容应包含

为了帮助我们快速理解和修复问题，请在报告中包含：

- **漏洞类型**: 例如 SQL 注入、XSS、路径遍历等
- **影响范围**: 哪些版本受影响
- **复现步骤**: 详细的步骤说明
- **概念验证**: PoC 代码或截图（如适用）
- **影响评估**: 您认为的严重程度和潜在影响
- **修复建议**: 如果您有修复方案（可选）
- **联系方式**: 以便我们跟进沟通

### 响应时间表

我们承诺：

- **48 小时内**: 确认收到报告
- **7 天内**: 提供初步评估和修复计划
- **30 天内**: 发布安全补丁（视严重程度而定）
- **修复后**: 与您协商披露时间表

### 安全更新发布

安全更新将通过以下渠道发布：

- GitHub Security Advisories
- GitHub Releases（标注为安全更新）
- 项目 README 的更新日志

## 安全范围 (Scope)

### 包含在安全范围内

本项目的安全范围包括：

- **核心引擎** (`tianlu-intel-core`)- 数据处理逻辑
  - SQL 查询构建
  - 文件操作
  - 命令行参数解析

- **采集器** (`tianlu_intel_collectors`)
  - API 调用安全
  - 数据解析逻辑
  - 输入验证
  - 凭证管理

- **Web UI** (`web_ui`)
  - 用户输入验证
  - XSS 防护
  - CSRF 防护
  - 会话管理

- **数据存储**
  - 数据库安全
  - 文件权限
  - 敏感信息保护

### 不包含在安全范围内

以下内容不属于本项目的安全漏洞：

- ❌ **第三方数据源**: 本项目收集的漏洞情报（CVE 数据）本身包含公开的漏洞信息
- ❌ **依赖库漏洞**: 除非直接影响本项目的安全性
- ❌ **配置错误**: 用户自行配置不当导致的安全问题
- ❌ **社会工程**: 针对用户的钓鱼或欺诈行为

## 安全最佳实践 (Security Best Practices)

### 对于用户

1. **保持更新**: 始终使用最新版本
2. **安全配置**:
   - 不要在公共仓库中提交 API 密钥
   - 使用环境变量存储敏感信息
   - 限制数据库文件的访问权限
3. **网络安全**:
   - 在受信任的网络环境中运行
   - 使用防火墙保护 Web UI 端口
4. **定期审计**: 检查日志文件和数据库内容

### 对于开发者

1. **代码审查**: 所有 PR 必须经过安全审查
2. **依赖管理**: 定期更新依赖并检查已知漏洞
3. **输入验证**: 严格验证所有外部输入
4. **最小权限**: 遵循最小权限原则
5. **安全测试**: 编写安全相关的测试用例

## 已知安全考虑 (Known Security Considerations)

### 本地数据库

- 数据库文件 (`tianlu_intel_v2.db`) 存储在本地
- 建议设置适当的文件权限（仅所有者可读写）
- 不包含用户凭证或敏感个人信息

### API 密钥管理

- 使用环境变量存储 API 密钥
- 不要在代码或配置文件中硬编码密钥
- 定期轮换 API 密钥

### Web UI 访问

- 默认绑定到 localhost (127.0.0.1)
- 如需远程访问，请使用反向代理和 HTTPS
- 考虑添加身份验证机制

## 致谢 (Acknowledgments)

我们感谢以下安全研究人员的负责任披露：

<!-- 安全研究人员名单将在此列出 -->

*目前还没有公开的安全报告。*

## 联系方式 (Contact)

- **安全邮箱**: security@tianlulab.com
- **项目主页**: https://github.com/tianlusec/TL-ICScan
- **安全公告**: https://github.com/tianlusec/TL-ICScan/security/advisories

---

**感谢您帮助保护 TL-ICScan 和我们的用户！**
